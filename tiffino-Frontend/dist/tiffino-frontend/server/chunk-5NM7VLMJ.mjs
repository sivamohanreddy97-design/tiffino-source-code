import './polyfills.server.mjs';
import{V as u}from"./chunk-VKAK7VJB.mjs";import{J as o,M as c,R as i,f as n,pc as l}from"./chunk-GVJVC3KI.mjs";var s=class{};var a="user",b=(()=>{class r{constructor(t,e){this.http=t,this.router=e,this.apiurl="http://localhost:8890",this.userSubject=new n(this.getUserFromLocalStorage()),this.userObservable=this.userSubject.asObservable()}get currentUser(){return this.userSubject.value}register(t){return this.http.post(`${this.apiurl}/users/register`,t).pipe(o({next:e=>{e.isAdmin=e.role==="ADMIN",this.setUserToLocalStorage(e),this.userSubject.next(e),console.log(`User registered successfully: ${e.id}`)},error:e=>{e.error instanceof ProgressEvent?console.error("Registration failed: Backend unreachable or network error",e):console.error("Registration failed:",e.error)}}))}login(t){return this.http.post(`${this.apiurl}/users/login`,t).pipe(o({next:e=>{localStorage.setItem("UserData",JSON.stringify(e)),this.currentiser=e,this.setUserToLocalStorage(e),this.userSubject.next(e)},error:e=>{console.log(e.error,"Login Failed")}}))}getUserFromLocalStorage(){let t=localStorage.getItem(a);return t?JSON.parse(t):new s}setUserToLocalStorage(t){localStorage.setItem(a,JSON.stringify(t))}logout(){this.userSubject.next(new s),localStorage.removeItem(a),console.log("User has logged out successfully.")}get currentUserValue(){if(!this.currentiser){let t=localStorage.getItem("user");t&&(this.currentiser=JSON.parse(t))}return this.currentUser}profile(t,e){return this.http.put(`${this.apiurl}/users/${t}`,e)}static{this.\u0275fac=function(e){return new(e||r)(i(l),i(u))}}static{this.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{b as a};
